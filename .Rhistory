stats::ks.test(rcnb(480, D, r1, r2, lambda), function(x){pcnb(x, D, r1, r2, lambda)})
dcnb(0:7, 7, 2, 0.4, 0.6)
dcnb(0:7, 7, 2, 0.4, 0.6)*1000
m = 1000
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
tmp <- rcnb(m, D, r1, r2, lambda)
hist(tmp)
observed <- rcnb(m, D, r1, r2, lambda)
observed
table(observed)
tmp <- table(observed)
tmp
names(tmp)
tmp[1]
class(tmp)
tmp[,"0"]
tmp["0"]
class(tmp["0"])
1+tmp["0"]
tmp <- table(observed)
sum(tmp)
?table
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
observed
expected
m = 2000
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
tested
?pchisq
pchisq(tested, D + 1)
qchisq(0.025, D + 1)
qchisq(0.025, D + 1, lower.tail = F)
dcnb(0:D, D, r1, r2, lambda)
dcnb(0:D, D, r1, r2, lambda)*100
# lambda < 1
m = 2000
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
expect_true( tested < stats::qchisq(0.025, D + 1, lower.tail = F))
qchisq(0.01, D + 1, lower.tail = F)
qchisq(0.025, D + 1, lower.tail = F)
qchisq(0.05, D + 1, lower.tail = F)
stats::qchisq(0.1, D + 1, lower.tail = F)
stats::qchisq(0.05, D + 1, lower.tail = F)
qchisq(0.05, D, lower.tail = F)
qchisq(0.01, D, lower.tail = F)
observed
expected
devtools::test()
devtools::test()
devtools::test()
devtools::test()
.Random.seed
rm(.Random.seed, envir=globalenv())
.Random.seed
# lambda < 1
m = 720
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
expect_true(tested < stats::qchisq(0.01, D, lower.tail = F))
tested
.Random.seed
rm(.Random.seed, envir=globalenv())
.Random.seed
m = 720
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
expect_true(tested < stats::qchisq(0.01, D, lower.tail = F))
tested
set.seed(2018)
# lambda < 1
m = 720
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
tested
stats::qchisq(0.2, D, lower.tail = F)
stats::qchisq(0.3, D, lower.tail = F)
stats::qchisq(0.4, D, lower.tail = F)
stats::qchisq(0.3, D, lower.tail = F)
set.seed(2018)
# lambda < 1
m = 720
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
tested
expect_true(tested < stats::qchisq(0.3, D, lower.tail = F))
rm(.Random.seed, envir=globalenv())
set.seed(2018)
# lambda < 1
m = 720
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
tested
expect_true(tested < stats::qchisq(0.3, D, lower.tail = F))
rm(.Random.seed, envir=globalenv())
set.seed(2018)
# lambda < 1
m = 720
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
tested
expect_true(tested < stats::qchisq(0.3, D, lower.tail = F))
rm(.Random.seed, envir=globalenv())
set.seed(2018)
# lambda < 1
m = 720
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
tested
expect_true(tested < stats::qchisq(0.3, D, lower.tail = F))
rm(.Random.seed, envir=globalenv())
runif(1)
set.seed(2018)
# lambda < 1
m = 720
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
tested
expect_true(tested < stats::qchisq(0.3, D, lower.tail = F))
rm(.Random.seed, envir=globalenv())
runif(1)
set.seed(2018)
# lambda < 1
m = 720
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
tested
expect_true(tested < stats::qchisq(0.3, D, lower.tail = F))
rm(.Random.seed, envir=globalenv())
runif(1)
set.seed(2018)
# lambda < 1
m = 720
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
tested
expect_true(tested < stats::qchisq(0.3, D, lower.tail = F))
rm(.Random.seed, envir=globalenv())
runif(1)
set.seed(2018)
# lambda < 1
m = 720
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
tested
expect_true(tested < stats::qchisq(0.3, D, lower.tail = F))
rm(.Random.seed, envir=globalenv())
runif(1)
set.seed(2018)
# lambda < 1
m = 720
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
tested
expect_true(tested < stats::qchisq(0.3, D, lower.tail = F))
rm(.Random.seed, envir=globalenv())
runif(1)
set.seed(2018)
# lambda < 1
m = 720
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
tested
expect_true(tested < stats::qchisq(0.3, D, lower.tail = F))
rm(.Random.seed, envir=globalenv())
runif(1)
set.seed(2018)
# lambda < 1
m = 720
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
tested
expect_true(tested < stats::qchisq(0.3, D, lower.tail = F))
rm(.Random.seed, envir=globalenv())
runif(1)
set.seed(2018)
# lambda < 1
m = 720
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
tested
expect_true(tested < stats::qchisq(0.3, D, lower.tail = F))
rm(.Random.seed, envir=globalenv())
runif(1)
set.seed(2018)
# lambda < 1
m = 720
D = 7
r1 = 2
r2 = 0.4
lambda = 0.6
observed <- table(rcnb(m, D, r1, r2, lambda))
expected <- dcnb(0:D, D, r1, r2, lambda) * m
tested <- sum((observed - expected)^2 / expected)
tested
expect_true(tested < stats::qchisq(0.3, D, lower.tail = F))
rm(.Random.seed, envir=globalenv())
runif(1)
stats::qchisq(0.3, D, lower.tail = F)
stats::qchisq(0.45, D, lower.tail = F)
stats::qchisq(0.5, D, lower.tail = F)
devtools::document()
devtools::test()
stats::qchisq(0.85, D, lower.tail = F)
stats::qchisq(0.9, D, lower.tail = F)
stats::qchisq(0.88, D, lower.tail = F)
devtools::test()
stats::qchisq(0.3, D, lower.tail = F)
stats::qchisq(0.4, D, lower.tail = F)
devtools::test()
devtools::test()
expect_error( mu_cnb(120, 90, 0.994) ) # missing an argument
expect_error( mu_cnb(-2000, 120, 90, 0.994) ) # D < 0
expect_error( mu_cnb(2000, -120, 90, 0.994) ) # r1 < 0
expect_error( mu_cnb(2000, 120, -90, 0.994) ) # r2 < 0
expect_error( mu_cnb(2000, 120, 90, -0.994) ) # lambda < 0
D <- 32
r1 <- 600
r2 <- 499
lambda <- 1
expect_equal(mu_cnb(D, r1, r2, lambda),  sum(rmutil::dbetabinom(0:D, D, r1/(r1+r2), r1+r2) * (0:D)))
D <- 64
r1 <- 563
r2 <- 49
lambda <- 0.72
expect_equal(mu_cnb(D, r1, r2, lambda),  sum(dcnb(0:D, D, r1/(r1+r2), r1+r2) * (0:D)))
D <- 64
r1 <- 563
r2 <- 49
lambda <- 0.72
expect_equal(mu_cnb(D, r1, r2, lambda),  sum(dcnb(0:D, D, r1, r2, lambda) * (0:D)))
D <- 99
r1 <- 60
r2 <- 588
lambda <- 1.32
expect_equal(mu_cnb(D, r1, r2, lambda),  sum(dcnb(0:D, D, r1, r2, lambda) * (0:D)))
devtools::test()
D <- 32
r1 <- 600
r2 <- 499
lambda <- 1
expect_equal(sigma2_cnb(D, r1, r2, lambda),  sum(rmutil::dbetabinom(0:D, D, r1/(r1+r2), r1+r2) * (0:D - mu_cnb(D, r1, r2, lambda))^2))
D <- 64
r1 <- 563
r2 <- 49
lambda <- 0.72
expect_equal(sigma2_cnb(D, r1, r2, lambda),  sum(dcnb(0:D, D, r1, r2, lambda) * (0:D - mu_cnb(D, r1, r2, lambda))^2))
devtools::document()
devtools::test()
getwd()
library(cnbdistr)
devtools::test()
devtools::document()
library(cnbdistr)
?dcnb
?qcnb
?range
browseVignettes("hypergeo")
browseVignettes("roxygen2")
install.packages("knitr")
install.packages("rmarkdown")
getwd()
devtools::use_vignette("my-vignette")
sessionInfo()
library(rmutil)
sessionInfo()
library(cnbdistr)
D <- 12
r1 <- 4
r2 <- 0.8
theta <- 0.6
x <- pcnb(0:D, D, r1, r2, theta)
plot(0:D, x, type='h', lwd=8, col = "dark green")
library(cnbdistr)
D <- 12
r1 <- 4
r2 <- 0.8
theta <- 0.6
x <- pcnb(0:D, D, r1, r2, theta)
plot(0:D, x, type='h', lwd=8, col = "dark green")
library(cnbdistr)
D <- 12
r1 <- 4
r2 <- 0.8
theta <- 0.6
x <- pcnb(0:D, D, r1, r2, theta)
plot(0:D, x, type='s', lwd=8, col = "dark green")
library(cnbdistr)
D <- 12
r1 <- 4
r2 <- 0.8
theta <- 0.6
x <- qcnb(seq(0, 1, 0.01), D, r1, r2, theta)
plot(seq(0, 1, 0.01), x, type='s', lwd=4, col = "palegreen3")
y <- qcnb(seq(0, 1, 0.01), D, r2, r1, 1/theta)
plot(seq(0, 1, 0.01), y, type='s', lwd=4, col = "royalblue3")
D <- 11
r1 <- 4
r2 <- 0.8
theta <- 0.65 # this is p1/p2
x <- pcnb(0:D, D, r1, r2, theta)
plot(0:D, x, type='s', lwd=4, col = "palegreen3")
library(cnbdistr)
D <- 11
r1 <- 4
r2 <- 0.8
theta <- 0.6 # this is p1/p2
x <- dcnb(0:D, D, r1, r2, theta)
plot(0:D, x, type='h', lwd=8, col = "palegreen3")
library(cnbdistr)
D <- 11
r1 <- 4
r2 <- 0.8
theta <- 0.65 # this is p1/p2
x <- dcnb(0:D, D, r1, r2, theta)
plot(0:D, x, type='h', lwd=8, col = "palegreen3")
library(cnbdistr)
D <- 11
r1 <- 4
r2 <- 0.85
theta <- 0.65 # this is p1/p2
x <- dcnb(0:D, D, r1, r2, theta)
plot(0:D, x, type='h', lwd=8, col = "palegreen3")
D <- 11
r1 <- 3
r2 <- 0.85
theta <- 0.65 # this is p1/p2
x <- dcnb(0:D, D, r1, r2, theta)
plot(0:D, x, type='h', lwd=8, col = "palegreen3")
library(cnbdistr)
D <- 11
r1 <- 3.8
r2 <- 0.85
theta <- 0.65 # this is p1/p2
x <- dcnb(0:D, D, r1, r2, theta)
plot(0:D, x, type='h', lwd=8, col = "palegreen3")
library(cnbdistr)
D <- 11
r1 <- 3.6
r2 <- 0.85
theta <- 0.65 # this is p1/p2
x <- dcnb(0:D, D, r1, r2, theta)
plot(0:D, x, type='h', lwd=8, col = "palegreen3")
D <- 11
r1 <- 3.2
r2 <- 0.85
theta <- 0.65 # this is p1/p2
x <- dcnb(0:D, D, r1, r2, theta)
plot(0:D, x, type='h', lwd=8, col = "palegreen3")
library(cnbdistr)
D <- 11
r1 <- 4
r2 <- 0.72
theta <- 0.65 # this is p1/p2
x <- dcnb(0:D, D, r1, r2, theta)
plot(0:D, x, type='h', lwd=8, col = "palegreen3")
library(cnbdistr)
D <- 11
r1 <- 4
r2 <- 0.9
theta <- 0.65 # this is p1/p2
x <- dcnb(0:D, D, r1, r2, theta)
plot(0:D, x, type='h', lwd=8, col = "palegreen3")
D <- 10
r1 <- 4
r2 <- 0.9
theta <- 0.65 # this is p1/p2
x <- dcnb(0:D, D, r1, r2, theta)
plot(0:D, x, type='h', lwd=8, col = "palegreen3")
D <- 11
r1 <- 4
r2 <- 0.8
theta <- 0.63 # this is p1/p2
x <- dcnb(0:D, D, r1, r2, theta)
plot(0:D, x, type='h', lwd=8, col = "palegreen3")
install.packages("knitcitations")
library(cnbdistr)
D <- 11
r1 <- 4
r2 <- 0.8
theta <- 0.63 # this is p1/p2
x <- rcnb(1e4, D, r1, r2, theta)
hist(x)
?hist
hist(x, D+1)
hist(x, seq(0.5, 10.5, 1))
hist(x, seq(0.5, 10.5, by = 1))
hist(x, seq(-0.5, 11.5, by = 1))
hist(x, seq(-0.5, 11.5, by = 1), col = 'tomato2')
hist(x, seq(-0.5, 11.5, by = 1), col = 'tomato3')
hist(x, seq(-0.5, 11.5, by = 1), col = 'oragered3')
hist(x, seq(-0.5, 11.5, by = 1), col = 'orangered3')
hist(x, seq(-0.5, 11.5, by = 1), col = 'orangered2')
hist(x, seq(-0.5, 11.5, by = 1), col = 'orangered1')
hist(x, seq(-0.5, 11.5, by = 1), col = 'orchid3')
hist(x, seq(-0.5, 11.5, by = 1), col = 'orchid4')
hist(x, seq(-0.5, 11.5, by = 1), col = 'orchid3')
hist(x, seq(-0.5, 11.5, by = 1), col = 'gray52')
install.packages("ggplot2")
getwd()
files.exists("~/.ssh/id_rsa.pub")
file.exists("~/.ssh/id_rsa.pub")
getwd()
ls
pwd
getwd()
file.exists("~/.ssh/id_rsa.pub")
getwd()
devtools:document
devtools:document()
library(devtools)
devtools:document()
devtools::document()
devtools::test()
library(cnbdistr)
devtools::document()
devtools::test()
library(devtools)
getwd()
devtools::document()
devtools::test()
library(cnbdistr)
